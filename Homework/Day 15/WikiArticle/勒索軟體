勒索軟體，又稱勒索病毒，是一種特殊的惡意軟體，又被人歸類為「阻斷存取式攻擊」（denial-of-access attack），其與其他病毒最大的不同在於手法以及中毒方式。其中一種勒索軟體僅是單純地將受害者的電腦鎖起來，而另一種則系統性地加密受害者硬碟上的檔案。所有的勒索軟體都會要求受害者繳納贖金以取回對電腦的控制權，或是取回受害者根本無從自行取得的解密金鑰以便解密檔案。勒索軟體通常透過木馬病毒的形式傳播，將自身為掩蓋為看似無害的檔案，通常會通過假冒成普通的電子郵件等社會工程學方法欺騙受害者點擊連結下載，但也有可能與許多其他蠕蟲病毒一樣利用軟體的漏洞在聯網的電腦間.....傳播。[1]

原先勒索病毒只在俄羅斯境內盛行，但隨著時間推進，受害者開始廣布全球。[2][3][4]2013年6月，網路安全公司McAfee釋出了一份數據，顯示該公司光在該年度（2013）第一季就取得了超過250,000種不同的勒索病毒樣本，並表示該數字是去年（2012）同季的超過兩倍。 [5] 隨著CryptoLocker的流行，加密形式的勒索軟體開始進行大規模的攻擊，在遭當局瓦解以前取得了估計三百萬美元的贖金。[6] 另一個勒索軟體CryptoWall，被美國聯邦調查局估計在2015年6月以前獲得了超過一百八十萬美元的贖金。[7]

勒索軟體通常透過木馬病毒的方式傳播，例如透過下載檔案夾帶，或是透過網路系統的漏洞而進入受害者的電腦。勒索軟體在進入後，會直接執行，或是透過網路下載病毒的實體數據，並恐嚇受害者。恐嚇訊息隨著不同的病毒而異，例如假借執法機關的名義，恐嚇受害者的電腦被發現進行非法行動，如色情、盜版媒體，或是非法的作業系統等。[8][9][10]

某些實體數據只將作業系統鎖住，直到受害者付清贖金後才將電腦解鎖。實體數據可能以數種手段來達成恐嚇，包括將Windows的使用者介面（Windows Shell）綁定為病毒程式，[11] 或甚至修改磁碟的主啟動磁區、硬碟分割表等。 [12] 最嚴重的一種實體數據將受害者的檔案加密，以多種加密方法讓受害者無法使用檔案，唯一的方法通常就是向該病毒的作者繳納贖金，換取加密金鑰，以解開加密檔案。[13][14][15]

獲得贖金是這類病毒的最終目標。要讓病毒的開發者不易被執法單位發現，匿名的繳款管道是開發者的必要元素。有數種的管道發現被開發者用作匿名繳款，例如匯款、簡訊小額付款[16]、線上虛擬貨幣（Ukash、Paysafecard）[2][17][18]、數位貨幣比特幣等。[19][20][21]

最早已知的此種病毒是1989年的"AIDS" Trojan病毒，由Joseph Popp製作。該病毒的實體數據會宣稱受害者的某個軟體已經結束了授權使用，並且加密磁碟上的檔案，要求繳出189美元的費用給PC Cyborg Corporation以解除鎖定。開發者Popp在法庭上以精神障礙（無行為能力）為自己辯護，但他仍承諾將獲得的非法款項用於資助愛滋病的研究。[22] 使用公開金鑰加密的構想是1996年由Adam L. Young和Moti Yung所提出的。兩人指出，AIDS Trojan之所以無法有效發揮作用，是因為其採用的是私鑰加密，該技術的加密金鑰會儲存於病毒的原始碼中，從而瓦解該病毒的作用。兩人並且實作了一隻概念驗證的實驗性病毒，在Macintosh SE/30電腦上使用RSA及TEA演算法加密資料。他們將這種行為稱作明顯的「加密病毒勒索」（cryptoviral extortion），屬於現今稱作加密病毒學中的一個分支。[13] 兩人在1996年的IEEE安全與隱私研討會（IEEE S&P）中描述了攻擊者利用電子貨幣從被害者身上勒贖的過程：「專門的加密病毒能被設計成搜尋受害者的電子貨幣並加密。這樣一來，攻擊者就能名正言順的保證受害者付錢，否則受害者將失去所有的電子貨幣。」


2005年5月開始，勒索軟體變得更為猖獗。[23] 在2006年中，勒索軟體開始運用更加複雜的RSA加密手段，甚至加長金鑰的長度，像是Gpcode、TROJ.RANSOM.A、Archiveus、Krotten、Cryzip、MayArchive等病毒。例如在2006年6月發現的Gpcode.AG使用了660位元的RSA公鑰。[24] 2008年6月，發現了該病毒的新變種Gpcode.AK。該變種使用了1024位元的RSA公鑰，據信在不使用分散式計算的情況下，破解該金鑰對單一電腦來說，將是徒勞無功的。[25][26][27][28]

加密勒索軟體隨著2013年尾開始出現行蹤的CryptoLocker又開始了新一波的活躍期，該病毒最大的差異在於利用新時代的比特幣進行勒索。2013年12月，ZDNet估計該病毒單單在該月（12月）15日至18日間，就利用比特幣從受害者身上汲取了2700萬美元的鉅額。[29]CryptoLocker的手法在緊接著的幾個月內被多種病毒所效仿，包括CryptoLocker 2.0（被認為和原始的CryptoLocker無關）、CryptoDefense（值得注意的是，該病毒的初始版本包含了一個嚴重的設計缺陷，將私鑰儲存在使用者能找到的位置，因為其使用Windows的內建加密API進行行動。）[20][30][31][32]，以及2014年8月一個專門針對群暉科技（Synology）生產的網路附加儲存（NAS）裝置進行攻擊的病毒。[33]

在2014年尾，High-Tech Bridge資安公司甚至發現了將整個伺服器上網站都加密的RansomeWeb病毒。[34]

在2015年，刊載了一份詳盡的報告，列舉出不同的勒索軟體所使用的加密技術、弱點，及可能的防範措施等。[35]

2017年5月，勒索軟體WannaCry大規模感染了包括西班牙電信在內的許多西班牙公司、英國國民保健署[36]、聯邦快遞和德國鐵路股份公司。據報導，至少有99個國家的其他目標在同一時間遭到WanaCrypt0r 2.0的攻擊。[37][38][39][40]俄羅斯聯邦內務部、俄羅斯聯邦緊急情況部和俄羅斯電信公司MegaFon共有超過1000台電腦受到感染。[41]中國教育網相連的中國大陸高校也出現大規模的感染[42]，感染甚至波及到了公安機關使用的內網[43]，使得河南省洛陽市的公安系統遭到破壞[44]。國家互聯網應急中心亦發布通報[45]。

2020年12月23日，美國各級政府部門、北約、英國政府、歐洲議會、微軟等至少200個政府單位、組織或公司遭遇資料泄露，影響範圍甚廣[46]。

2021年5月7日，起源於美國德克薩斯州休斯敦、主要負責向美國東南部運輸重油的石油管道系統殖民管道遭遇DarkSide發動的勒索軟體網路攻擊，影響負責管理管道的電腦系統，導致服務地區出現燃油短缺情況[47]。

在2010年8月，俄羅斯當局逮捕了十名與WinLock木馬病毒有關聯的嫌犯。WinLock病毒並不像前面所提到的Gpcode一樣對電腦加密，相反的，WinLock顯示色情圖片遮擋使用者的電腦螢幕，並提示受害者利用大約10美元的簡訊付費以接收解鎖的密碼。這個病毒襲擊了俄羅斯及鄰近國家的許多人，並被報導指出，攻擊者賺取了超過一千六百萬美元的收入。[10][48]

2011年，一個勒索軟體假藉Windows產品啟用的名義行騙，提示受害者的Windows因為是詐騙的受害者（victim of fraud），所以必須重新啟用。就像真正的產品啟用一樣，病毒也提供了線上啟動的選項，卻顯示成無法使用，並要求受害者撥打六支國際電話的其中一隻，並且輸入六位數密碼。雖然病毒宣稱該電話號碼為免費撥打，電話卻實際上會被轉接到高費率的國家，再刻意將該通話置於保留（on hold），藉此讓受害者付出高額的國際長途電話費用。[8]

2013年，一款基於Stamp.EK攻擊套件的病毒浮上檯面。該病毒散發訊息在各個SourceForge和GitHub專案頁面中，並宣稱提供名人的假造裸照。[49] 2013年7月，一個針對OS X的勒索軟體出現。該病毒會顯示一個網頁，宣稱受害者被發現下載色情媒體。不像Windows的病毒一樣對整個系統上鎖，該病毒只能利用點擊劫持來混淆受害者的視聽，試圖不讓受害者用正常方式關閉該頁面。[50]

2013年7月，一名來自維吉尼亞州的21歲男子中了勒索軟體，卻在巧合之下，因為自己的電腦確實儲存了和他聊天過的未成年少女的裸照，而病毒顯示FBI查獲兒童色情媒體的警告，向警方自首。[51]
2016年1月，也發現了威脅要將受害者的瀏覽紀錄公開的勒索軟體。[52]

2012年，一款叫做Reveton的勒索軟體開始廣布。該病毒基於Citadel木馬病毒，而病毒的有效數據會顯示假造成來自執法機關的訊息（因此，此類病毒又被稱為police Trojan或cop Trojan）。該病毒會宣稱執法機關查獲該電腦有非法活動，例如下載盜版軟體或是兒童色情媒體[53] ，並且提示受害者使用Ukash 或Paysafecard等匿名電子貨幣進行繳納。為了更進一步取信於被害人，該警訊也會同時列出受害者的IP位址，某些版本甚至會顯示受害者網路攝影機的畫面。[2][54]

Reveton在2012年開始在歐洲各國間活動。[2]變種則有各式各樣的在地化版本，搭配受害者語言與當地執法機關的圖示。例如在英國的變種就會顯示成倫敦警察廳、著作權集體管理團體 PRS for Music（搭配受害者下載盜版音樂的警告）、PeCU等。[55] 倫敦警察廳曾公開澄清，執法單位絕對不會像病毒一樣，將使用者的電腦以調查名義鎖上。[2][9]

2012年5月，趨勢科技研究員發現美國及加拿大的版本，代表病毒開發者可能本來有意攻擊北美地區。[56] 2012年8月，Reveton的新變種開始在美國流竄，要求受害者用MoneyPak卡向FBI繳納200美元的罰鍰。[3][4][54] 2013年2月，一個俄羅斯公民在杜拜遭西班牙當局逮捕，因為被發現他所屬的犯罪組織曾使用過Reveton；十名共犯則以洗錢罪名逮捕。[57]

2014年8月，Avast Software回報發現新變種，攜帶竊取密碼的軟體作為實體數據之一。[58]

2013年9月，加密性勒索軟體以CryptoLocker之姿重出江湖。該病毒使用2048位元的RSA加密金鑰，並將其回傳至主控病毒行動的伺服器。關於加密檔案，該病毒使用白名單以只對特定的副檔名加密。CryptoLocker威脅受害者，若不以比特幣或付費卡在三天內繳款，就會將所有加密檔案刪除。由於其使用了極大長度的金鑰，被其加密的檔案一般是認為無法復原的。[19][59][60][61] 儘管付款期限已過，解密的金鑰仍能利用其提供的線上工具取得，但是價格會增加為10BTC，相當於2300美元（2013年11月匯率）。[62][63]

美國司法部在2014年6月2日宣布，CryptoLocker在Gameover ZeuS殭屍網路遭到執法機關關閉後被分離出來。司法部也提起了對俄國駭客Evgeniy Bogachev的公訴，因為其對該殭屍網路運作的涉入。[64][65] 據估計，在該病毒遭關閉前，已經獲得了至少三百萬美元的收入。[6]

2014年9月，新一波針對澳洲的勒索攻擊開始，以CryptoWall及CryptoLocker（連同CryptoLocker 2.0，不和原始CryptoLocker有關）。該病毒透過假造的電子郵件散布，宣稱受害者有投遞失敗的澳大利亞郵政包裹。為了避開安全軟體的掃瞄，該變種會先提示使用者輸入CAPTCHA驗證碼來誘使受害者下載病毒數據。賽門鐵克確認了該變種，命名為CryptoLocker.F。[66][67] 其中的一個受害者是澳洲廣播公司，而其現場轉播的新聞頻道ABC News 24被迫中斷半小時並轉至墨爾本攝影棚錄影，因為雪梨的攝影棚被該病毒攻擊了。[68][69][70]

另一個搭上順風車的病毒TorrentLocker，最初含有與CryptoDefense類似的缺陷。該病毒對每台受感染的電腦都使用相同的密鑰流，導致安全單位能利用此弱點解開加密的檔案。該缺陷在後來的版本中被修正了。[30] 在2014年尾，估計光是澳洲就有超過9000名受害者受TorrentLocker所害，僅次於土耳其的11,700名。[71]

另一個針對Windows的重大病毒CryptoWall在2014年出現。CryptoWall隨著Zedo廣告網的惡意廣告散布。在2014年9月，其針對數個主要網站進行了攻擊，將受害者導向至獨立網站，利用瀏覽器漏洞傳輸病毒。一名Barracuda Networks研究員發現該病毒帶有數位簽章，以取信於安全軟體。[72] 
CryptoWall 3.0以JavaScript寫成，作為電子郵件的附加檔案。該指令碼會下載偽裝成JPG圖檔的可執行檔。為了更進一步避開偵測，該病毒會建立複製的explorer.exe及svchost.exe與其伺服器溝通。建立加密檔案時，該病毒也會同時刪除系統還原的備份檔案，並且安裝間諜軟體，竊取受害者的密碼與比特幣錢包。[73]

聯邦調查局表示，在2015年6月有上千名的受害者向網路犯罪回報中心回報了CryptoWall的感染，估計損失至少一千八百萬美元。[7]

在最新的4.0版本中，CryptoWall改進了其程式碼以避免防毒軟體的偵測，並且除了檔案內容外，也一併加密檔案名稱。[74]

KeRanger在2016年3月出現，是第一個在OS X作業系統上運作的勒索軟體。該病毒加密受害者的個人檔案，並且要求1BTC的贖金以解密檔案。該病毒將.DMG可執行檔偽裝成RTF檔案。該病毒會潛伏三日，接著開始加密檔案，再附上一個寫入解密教學的文字檔案。該病毒也使用2048位元的RSA公鑰加密檔案。後續研究表明，該病毒其實是Linux.Encoder.1為OS X系統而重寫的。

RSA4096是目前加密性勒索軟體的最新世代。最初出現於2015年，該病毒使用公鑰加密，付款則要求受害者利用比特幣向暗網內的代理人購買，卻不保證在付款後能取回私鑰。該病毒有數種變種，大部分都尚未找到解決辦法。某些變種會將檔案的副檔名改變。唯一從攻擊中復原的方法，除了付費購買私鑰以外，只有從外部裝置復原受感染的檔案一途。 由於比特幣匯率近年的大幅上升，贖金的價格也相對的上升了。在2016年4月，該價格大約為三十萬英鎊。

 Manamecrypt (CryptoHost)[75]

該病毒宣稱加密受害者的檔案，並且要求1/3BTC（大約140美元）來解密檔案。事實上，該病毒卻不將檔案加密，而是將檔案移動進入密碼保護的RAR壓縮檔。 不過壓縮檔的密碼很容易找到，使得受害者有方法能取回受感染的檔案。 

CryptoHost將受害者的檔案移至C:\Users\使用者名稱\AppData\Roaming的一個RAR壓縮檔內。 檔案名稱為41個字元，且沒有副檔名。

CryptoHost目前綑綁在竄改的μTorrent安裝程式內，將自身的cryptohost.exe解壓縮進入%AppData%後執行病毒。

Mischa是一款勒索軟體，並且和Petya勒索軟體有明顯的關聯。 該病毒會將加密的檔案改為特定的副檔名，如.3P7m、.arpT、.eQTz、.3RNu等。遭受感染的受害者電腦會在瀏覽器內顯示出威脅訊息，聲稱電腦已經遭到「軍規級加密」。該病毒也利用Tor瀏覽器和暗網（Tor隱藏服務）要求比特幣贖金，價值通常介於20美元至1000美元間。

WannaCrypt是利用Windows系統漏洞進行侵入的一款勒索病毒，在2017年5月12日後全球超過230,000台電腦皆遭此病毒侵害，此病毒要求支付價值等同於300美元的比特幣才可解密所有遭加密檔案。受害者電腦大多數皆裝載Windows 7系統，微軟也針對此漏洞進行更新。[76]

Petya於2016年3月首次出現，不像其他加密勒索軟體，該惡意軟體旨在感染主開機紀錄，安裝有效負載，受感染的系統下次啟動時便加密NTFS檔案系統檔案表，完全阻止系統啟動進Windows，直至支付贖金。Check Point報告指出，儘管該軟體被認為是勒索軟體設計上的創新性進展，但和在相同時間範圍內話語的其他軟體相比，感染率相對較低[77]。

2017年6月27日，Petya重大修改版本被用來反動主要針對烏克蘭的全球性網路攻擊。經修改的版本和WannaCry同樣使用永恆之藍漏洞傳播。由於設計變更，即使支付贖金系統也不會真正解鎖，故安全分析師猜測這次襲擊不是為了取得非法利益，僅僅是搞破壞[78][79]。

2017年10月24日，俄羅斯和烏克蘭有使用者報告了新型勒索軟體「Bad Rabbit」。類似於WannaCry和Petya的模式，Bad Rabbit加密了使用者的檔案表後，要求支付比特幣解鎖。ESET認為，該勒索軟體偽裝成Adobe Flash更新發布[80]。受影響的機構包括國際文傳電訊社、敖德薩國際機場、基輔地鐵和烏克蘭基礎設施部[81]。由於利用網路結構進行傳播，軟體也流入到別國，如土耳其、德國、波蘭、日本、韓國和美國[82]。專家認為此番襲擊和烏克蘭的Petya襲擊有關，儘管罪魁禍首的唯一標識是將《權力的遊戲》系列角色的名字嵌入代碼[82]。

安全專家發現，軟體沒有使用永恆之藍漏洞，這種給執行舊版Windows的未被感染的機器接種疫苗的簡單方法傳播[83][84]。此外，一直用來傳播假Flash更新已經離線，或是在勒索軟體被發現後幾天內刪除了有問題的檔案，從而有效阻止軟體傳播[82]。

暗網中已有越來越多的人宣稱提供勒索軟體作為服務，例如現在已經失效的Tox[85]與Encryptor RaaS等。[86]

就像其他形式的惡意軟體一樣，安全軟體不一定能偵測出勒索軟體的實體數據──尤其是加密用的軟體──直到開始加密或是完成加密了才被發現。對於未知的病毒來說更是如此。[87] 若攻擊尚在早期階段，加密檔案尚未成功，此時強制移除病毒實體數據就能避免對資料的進一步加密，例如拔除電源等物理性做法也是可以搶救回部分資料。[88][89] 安全專家建議了一些預防措施來應對勒索軟體，例如使用安全軟體或設定以避免已知的勒索軟體執行；保留與不與電腦連接的資料備份，尤其某些病毒會將仍與電腦連接的備份檔案一併加密。[19][90]非加密性勒索軟體能被專家移除，或是利用現成的安全軟體刪除。

雖然勒索軟體的威脅無法被完全革除，使用IT業界所稱的多層次預防策略（defense-in-layers security strategy）卻稱得上是不錯的預防手段。多層次預防策略提倡同時部署多種獨立、領域互相重疊的安全措施以建立穩固的安全措施。各安全層被設計和其他安全層互補，使得威脅不易穿透重重防護。例如一個安全策略可能包含下列五層： [1]

尼爾·史蒂芬森的小說Reamde探討一次勒索軟體的攻擊及其後果。

